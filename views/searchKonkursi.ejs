<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

</head>
<body style="background-color: #f4f5f7;">
<% if (uloga === 'korisnik') { %>
    <%- include('components/userNav') %>
<% } else if (uloga === 'admin') { %>
    <%- include('components/adminNav') %>
<% } %>

<section class="pt-4 padding-kartice">
    <div class="">
        <h6>Unesite naziv firme, pozicije, lokaciju ili stručnu spremu: </h6>
        <form action="/konkursi/search" method="get" class="d-flex">
            <input type="text" name="search" class="form-control me-2"   placeholder="Pretraži" value="<%= search %>">
            <button type="submit" class="btn btn-primary">Pretraži</button>
        </form>
    </div>

    <div class="table-container mt-4">
        <div class="table table-responsive">

            <table class="table table-striped table-bordered">
                <thead>
                <tr>
                    <th><a href="/konkursi/search?sort=naziv&order=<%= order === 'asc' ? 'desc' : 'asc' %>">Naziv</a></th>
                    <th><a href="/konkursi/search?sort=naziv_firme&order=<%= order === 'asc' ? 'desc' : 'asc' %>">Naziv firme</a></th>
                    <th><a href="/konkursi/search?sort=pozicija&order=<%= order === 'asc' ? 'desc' : 'asc' %>">Pozicija</a></th>
                    <th><a href="/konkursi/search?sort=strucna_sprema&order=<%= order === 'asc' ? 'desc' : 'asc' %>">Stručna sprema</a></th>
                    <th><a href="/konkursi/search?sort=lokacija&order=<%= order === 'asc' ? 'desc' : 'asc' %>">Lokacija</a></th>
                    <th><a href=""></a></th>
                </tr>
                </thead>
                <tbody id="konkursi-tbody">
                <% konkursi.forEach(konkurs => { %>
                    <tr>
                        <td><%= konkurs.naziv %></td>
                        <td><%= konkurs.naziv_firme %></td>
                        <td><%= konkurs.pozicija %></td>
                        <td><%= konkurs.strucna_sprema %></td>
                        <td><%= konkurs.lokacija %></td>
                        <% if (uloga === 'korisnik') { %>
                            <td><a href="/konkursi/<%= konkurs.id %>"><button class="btn btn-secondary">Detaljnije</button></a></td>
                        <% } else if (uloga === 'admin') { %>
                            <td><a href="/admin/prijave/<%= konkurs.id %>"><button class="btn btn-secondary">Prijave</button></a></td>
                        <% } %>
                    </tr>
                <% }); %>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div class="pagination justify-content-center">
            <% for (let i = 1; i <= Math.ceil(total / limit); i++) { %>
                <a href="/konkursi/search?page=<%= i %>&search=<%= search %>&sort=<%= sort %>&order=<%= order %>" class="page-link <%= i === page ? 'active' : '' %>"><%= i %></a>
            <% } %>
        </div>
    </div>

    <div class="filters mt-4">
        <form action="/konkursi/search" method="get" class="row">
            <div class="col-md-4 mb-2">
                <label for="sort" class="form-label">Sortiraj po:</label>
                <select name="sort" class="form-select">
                    <option value="naziv" <%= sort === 'naziv' ? 'selected' : '' %>>Naziv</option>
                    <option value="naziv_firme" <%= sort === 'naziv_firme' ? 'selected' : '' %>>Naziv firme</option>
                    <option value="pozicija" <%= sort === 'pozicija' ? 'selected' : '' %>>Pozicija</option>
                    <option value="strucna_sprema" <%= sort === 'strucna_sprema' ? 'selected' : '' %>>Stručna sprema</option>
                    <option value="lokacija" <%= sort === 'lokacija' ? 'selected' : '' %>>Lokacija</option>
                </select>
            </div>

            <div class="col-md-4 mb-2">
                <label for="order" class="form-label">Redoslijed:</label>
                <select name="order" class="form-select">
                    <option value="asc" <%= order === 'asc' ? 'selected' : '' %>>Asc</option>
                    <option value="desc" <%= order === 'desc' ? 'selected' : '' %>>Desc</option>
                </select>
            </div>

            <div class="col-md-4 mb-2 d-flex align-items-end">
                <button type="submit" class="btn btn-secondary w-100">Filtriraj</button>
            </div>
        </form>
    </div>
    </section>

    <%- include('components/footer') %>


    <script src="	https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
