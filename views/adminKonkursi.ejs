<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

</head>
<body style="background-color: #f4f5f7;">
<!--NAVBAR-->
<%- include('components/adminNav') %>

<!--naslovna -->
<header class="py-5">
    <div class="container px-lg-5">
        <div class="p-4 p-lg-5 bg-light rounded-3 text-center">
            <div class="m-4 m-lg-5">
                <h1 class="display-5 fw-bold">Dobrodošli!</h1>
                <p class="fs-4">
                    Pretražite listu svih aktivnih i arhiviranih konkursa, upravljajte njima i organizujte svoje vrijeme!
                </p>
                <a href="/konkursi/search"><button>Pretraži konkurse</button></a>
            </div>
        </div>
    </div>
</header>
<!-- Search opcije  -->
<section class="pt-4 padding-kartice">
    <h3 class="text-center">Aktivni konkursi</h3>
    <hr>
    <div class="row gx-lg-5 mt-5">
        <% if (aktivniKonkursi && aktivniKonkursi.length > 0) { %>
            <% aktivniKonkursi.forEach(konkurs => { %>
                <div class="col-lg-6 col-xxl-4 mb-5">
                    <div class="card boja-kartice border border-black h-100 mt-3">
                        <div class="card-body text-center p-4 p-lg-5 pt-0 pt-lg-0">
                            <h2 class="fs-4 fw-bold mb-3 mt-3"><%= konkurs.naziv %></h2>
                            <p class="mb-0"><strong>Firma:</strong> <%= konkurs.naziv_firme %></p>
                            <p><strong>Lokacija:</strong> <%= konkurs.lokacija %></p>
                            <p><strong>Pozicija:</strong> <%= konkurs.pozicija %></p>
                            <p><strong>Rok:</strong> <%= konkurs.rok_prijave %></p>

                            <button type="button" class="btn btn-primary mt-3" onclick="window.location.href = '/konkursi/<%= konkurs.id %>';">Detaljnije</button>
                            <button type="button" class="btn btn-primary mt-3" onclick="window.location.href = '/admin/prijave/<%= konkurs.id %>';">Prijave</button>

                            <button type="button" class="btn btn-danger mt-3" onclick="deleteKonkurs(<%= konkurs.id %>)">Obriši</button>
                        </div>
                    </div>
                </div>
            <% }) %>
        <% } else { %>
            <p class="text-center">Nema dostupnih konkursa.</p>
        <% } %>
    </div>

    <h3 class="text-center">Arhivirani konkursi</h3>
    <hr>
    <div class="row gx-lg-5 mt-5">
        <% if (arhiviraniKonkursi && arhiviraniKonkursi.length > 0) { %>
            <% arhiviraniKonkursi.forEach(konkurs => { %>
                <div class="col-lg-6 col-xxl-4 mb-5">
                    <div class="card boja-kartice border border-black h-100 mt-3">
                        <div class="card-body text-center p-4 p-lg-5 pt-0 pt-lg-0">
                            <h2 class="fs-4 fw-bold mb-3 mt-3"><%= konkurs.naziv %></h2>
                            <p class="mb-0"><strong>Firma:</strong> <%= konkurs.naziv_firme %></p>
                            <p><strong>Lokacija:</strong> <%= konkurs.lokacija %></p>
                            <p><strong>Pozicija:</strong> <%= konkurs.pozicija %></p>
                            <p><strong>Rok:</strong> <%= konkurs.rok_prijave %></p>
                            <button type="button" class="btn btn-primary mt-3" onclick="window.location.href = '/konkursi/<%= konkurs.id %>';">Detaljnije</button>
                        </div>
                    </div>
                </div>
            <% }) %>
        <% } else { %>
            <p class="text-center">Nema arhiviranih konkursa.</p>
        <% } %>
    </div>
</section>



<!--Futer-->

<%- include('components/footer') %>

<script src="/javascripts/search.js"></script>
<script>
    function deleteKonkurs(konkursId) {
        if (confirm('Da li ste sigurni da želite da obrišete ovaj konkurs?')) {
            fetch(`/admin/konkursi/${konkursId}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
                .then(response => {
                    if (response.ok) {
                        alert('Konkurs uspešno obrisan!');
                        window.location.reload();
                    } else {
                        alert('Došlo je do greške prilikom brisanja konkursa.');
                    }
                })
                .catch(error => {
                    console.error('Greška:', error);
                    alert('Došlo je do greške.');
                });
        }
    }
</script>
<script src="	https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


</body>
</html>